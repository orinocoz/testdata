---
- name: Initial setup
  hosts: all
  become: true
  roles:
    - init
  tags: i

- name: Web server
  hosts: web_servers
  become: true
  roles:
    - agama
    - uwsgi
    - nginx
  tags: w

- name: Database server
  hosts: db_servers
  roles:
    - mysql
  tags: m

- name: DNS server
  hosts: dns_servers
  become: true
  gather_facts: yes
  roles:
    - bind
  tags: b

- name: DNS resolver
  hosts: all
  become: true
  gather_facts: yes
  roles: 
    - resolve
  tags: r

- name: Prometheus server
  hosts: prometheus
  roles:
    - nginx
    - prometheus
  tags: p

- name: Grafana
  hosts: grafana
  roles:
    - nginx
    - grafana
  tags: g

- name: Influx DB
  hosts: influxdb
  roles:
    - influxdb
  tags: if

- name: Agama client
  hosts: agama_client
  roles:
    - agama_client
  tags: ac

- name: Docker servers
  hosts: docker
  roles:
    - docker
  tags: d
